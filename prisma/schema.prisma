// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  Int         @id @default(autoincrement())
  userName            String
  email               String      @unique
  password            String?
  userRole            String      @default("NormalProfile")
  facebookId          String?     @unique
  googleId            String?     @unique
  publicIdImgUrl      String?
  profilePictureURL   String?
  externalAccessToken String?
  resetToken          String?     
  resetTokenExpiry    Int? 
  galleries           Media[]
  donations           Donations[]
  comment             Comments[]
  post                Post[]
  answer              Answer[]
}

model Post {
  typeOf      String
  id          Int        @id @default(autoincrement())
  title       String
  description String
  timestamp   DateTime
  media       Media[]
  user_id     Int
  user        User       @relation(fields: [user_id], references: [id])
  comments    Comments[]
}

model Media {
  id          Int    @id @default(autoincrement())
  imgName     String
  imageUrl    String
  Description String
  post_id     Int
  post        Post   @relation(fields: [post_id], references: [id])
  user_id     Int
  user        User   @relation(fields: [user_id], references: [id])
}

model Donations {
  id               Int      @id @default(autoincrement())
  amount           Decimal  @db.Decimal(10, 2)
  concurrency      String
  paypament_status String
  paypament_method String
  stripe_charge_id String
  user_id          Int
  operationdate    DateTime
  timeofoperation  DateTime
  user             User     @relation(fields: [user_id], references: [id])
}

model Comments {
  id        Int      @id @default(autoincrement())
  user      User?    @relation(fields: [user_id], references: [id])
  user_id   Int?
  comment   String
  timestamp DateTime
  post_id   Int
  post      Post     @relation(fields: [post_id], references: [id])
  answer    Answer[]

  @@index([user_id], name: "user_id")
}

model Answer {
  id         Int      @id @default(autoincrement())
  answer     String
  comment_id Int
  comments   Comments @relation(fields: [comment_id], references: [id])
  user       User?    @relation(fields: [user_id], references: [id])
  user_id    Int?
}
